--Made By https://discord.gg/FWtTCTpSnc (Discord Server)
--[[
FFFFFFFFF    UU      UU    NN      NN    CCCCCCCC    TTTTTTTTTT    IIIIIIIII    OOOOOOOOO    NNN      NN    SSSSSSSS
FF          UU      UU    NNN     NN   CC                TT          II      OO        OO   NNNN     NN  SS        
FFFFFFFFF   UU      UU    NN  NN  NN   CC                TT          II      OO        OO   NN NN    NN   SSSSSSS 
FF           UU    UU     NN    NNNN   CC                TT          II      OO        OO   NN  NN   NN         SS
FF             UUUU       NN      NN    CCCCCCCC        TT        IIIIIIIII    OOOOOOOOO    NN    NNNN    SSSSSSSS

]]--

local me = game.Players.LocalPlayer
local mename = me.Name
local mechar = me.Character
local meroot = mechar:WaitForChild("HumanoidRootPart")
local mehead = mechar:WaitForChild("Head")
local mehum = mechar:WaitForChild("Humanoid")
local ownerusername = "EzPScript"
function msg(a)
    print(a)
end

-- Teleports
function teleport(x, y, z)
meroot.CFrame = CFrame.new(x, y, z)
end
function teleporttoplayer(playername)
meroot.CFrame = CFrame.new(game.Players[playername].Character.PrimaryPart.Position)
end
----CLOSE TELEPORTS---------------------------------------------------------------
-- ESP

local desp = false
local hesp = false
local nesp = false

function name(turn)
    nesp = turn
    updateESP()
end

function updateESP()
    for i, v in pairs(game.Players:GetPlayers()) do
        if v ~= game.Players.LocalPlayer then
            if nesp and not v.Character:WaitForChild("Head"):FindFirstChild("BillName") then
                local e = Instance.new("BillboardGui", v.Character:WaitForChild("Head"))
                local i = Instance.new("TextLabel", e)

                e.AlwaysOnTop = true
                e.ResetOnSpawn = false
                e.Name = "BillName"
                e.LightInfluence = 0
                e.Size = UDim2.new(0, 10, 0, 10)

                i.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                i.Text = v.Name
                i.Size = UDim2.new(0.0001, 0.00001, 0.0001, 0.00001)
                i.BorderSizePixel = 4
                i.LineHeight = 2
                i.Name = v.Name
                i.BorderColor3 = Color3.new(255, 10, 30)
                i.BorderSizePixel = 0
                i.Font = "SourceSans"
                i.TextSize = 15
                i.TextStrokeTransparency = 0

                local function updateColor()
                    local teamColor = v.TeamColor.Color
                    i.TextColor3 = teamColor
                end

                updateColor()
            elseif not nesp then
                local head = v.Character:FindFirstChild("Head")
                local billName = head and head:FindFirstChild("BillName")
                if billName then
                    billName:Destroy()
                end
            end
        end
    end
end

function fixederror()
    game:GetService("RunService").Heartbeat:Connect(function()
        if nesp == true then
            for i, v in pairs(game.Players:GetPlayers()) do
                if v ~= game.Players.LocalPlayer then
                    local character = v.Character
                    if character and not character:FindFirstChild("BillName") then
                        updateESP()
                    end
                end
            end
        end
    end)
end

game.Players.PlayerAdded:Connect(function(plr)
    plr.CharacterAdded:Connect(function(char)
        updateESP()
        fixederror()
    end)
end)

--[[local function health(parent, text, hum, turn)
    if turn then
hesp = turn
        if not parent:FindFirstChild("BillHP") then
            local e = Instance.new("BillboardGui", parent)
            local i = Instance.new("TextLabel", e)

            e.AlwaysOnTop = true
            e.ResetOnSpawn = false
            e.Name = "BillHP"
            e.LightInfluence = 0
            e.Size = UDim2.new(0, 10, 0, 10)

            i.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            i.Size = UDim2.new(0.0001, 0.00001, 0.0001, 0.00001)
            i.BorderSizePixel = 4
            i.Name = "Health"
            i.LineHeight = 0
            i.BorderColor3 = Color3.new(255, 10, 30)
            i.BorderSizePixel = 0
            i.Font = "SourceSans"
            i.TextXAlignment = "Right"
            i.TextSize = 15
            i.TextStrokeTransparency = 0
            i.TextColor3 = Color3.fromRGB(0, 255, 0)

            local function updateHealth()
                i.Text = "|HP|: " .. math.floor(hum.Health)
            end

            updateHealth() -- Actualizar el texto al crearlo

            hum:GetPropertyChangedSignal("Health"):Connect(updateHealth)
        end
    end
end

local function distance(parent, text, head, turn)
    if turn then
desp = turn
        if not parent:FindFirstChild("BillDistance") then
            local e = Instance.new("BillboardGui", parent)
            local i = Instance.new("TextLabel", e)

            e.AlwaysOnTop = true
            e.ResetOnSpawn = false
            e.Name = "BillDistance"
            e.LightInfluence = 0
            e.Size = UDim2.new(0, 10, 0, 10)

            i.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            i.Size = UDim2.new(0.0001, 0.00001, 0.0001, 0.00001)
            i.BorderSizePixel = 4
            i.Name = "Studs"
            i.LineHeight = 0
            i.BorderColor3 = Color3.new(255, 10, 30)
            i.BorderSizePixel = 0
            i.Font = "SourceSans"
            i.TextXAlignment = "Left"
            i.TextSize = 15
            i.TextStrokeTransparency = 0
            i.TextColor3 = Color3.fromRGB(255, 255, 255)

            local function updateDistance()
                local distanceValue = (game.Players.LocalPlayer.Character.Head.Position - head.Position).magnitude
                i.Text = "   |" .. math.floor(distanceValue) .. "|"
            end

            game:GetService("RunService").Heartbeat:Connect(function()
                updateDistance()
            end)
        end
    end
end

game.Players.PlayerAdded:Connect(function(plr)
    plr.CharacterAdded:Connect(function(char)
        if char then
            local humanoid = char:WaitForChild("Humanoid")
            if humanoid then
                local head = char:WaitForChild("Head")
                if head then
                    if nesp then
                        name(char:WaitForChild("Head"), char.Name, plr, nesp)
                    end
                    if hesp then
                        health(char:WaitForChild("Head"), math.floor(humanoid.Health), humanoid, hesp)
                    end
                    if desp then
                        local distanceValue = (game.Players.LocalPlayer.Character.Head.Position - char.Head.Position).magnitude
                        distance(char:WaitForChild("Head"), distanceValue, head, desp)
                    end
                end
            end
        end
    end)
end)

game.Players.PlayerRemoving:Connect(function(plr)
    for i, l in pairs(workspace:GetDescendants()) do
        if l.Name == plr.Name .. "  " then
            l.Parent:Destroy()
        end
    end
end)

game:GetService("RunService").Heartbeat:Connect(function()
print("Hello2")
    for i, h in pairs(game.Players:GetPlayers()) do
        if h ~= game.Players.LocalPlayer then
            local char = h.Character
            if char then
                local humanoid = char:WaitForChild("Humanoid")
                if humanoid then
                    local head = char:WaitForChild("Head")
                    if head then
                        local b = head:FindFirstChild("BillName")
                        if nesp and not b then
                            name(char:WaitForChild("Head"), char.Name, h, nesp)
                        elseif not nesp and b then
                            b:Destroy()
                        end

                        local h = head:FindFirstChild("BillHP")
                        if hesp and not h then
                            health(char:WaitForChild("Head"), math.floor(humanoid.Health), humanoid, hesp)
                        elseif not hesp and h then
                            h:Destroy()
                        end

                        local d = head:FindFirstChild("BillDistance")
                        if desp and not d then
                            local distanceValue = (game.Players.LocalPlayer.Character.Head.Position - char.Head.Position).magnitude
                            distance(char:WaitForChild("Head"), distanceValue, head, desp)
                        elseif not desp and d then
                            d:Destroy()
                        end
                    end
                end
            end
        end
    end
end)
]]--
---------------------------CLOSE ESP
